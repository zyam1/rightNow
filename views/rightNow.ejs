<!DOCTYPE html>
<html lang="kr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- css -->
    <link rel="stylesheet" href="/static/css/rightNow.css">
    <!-- cdn -->
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
    <style>
        /* 스타일을 적용할 부분을 추가하세요. */
        #modalContainer {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 20px;
            text-align: center;
            z-index: 1000;
            width: 300px; /* 정사각형으로 만들기 위한 가로 크기 설정 */
            height: 300px; /* 정사각형으로 만들기 위한 세로 크기 설정 */
        }

        #inputText {
            width: 200px;
            margin-top: 20px;
            border: none;
            background: transparent;
            display: block;
            margin: 0 auto;
        }
        .centerImg {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 35%;
        }
    </style>
    <title>R!ghtNow</title>
</head>
<body>
    <div class="go-mainButton">
        <a href="/">
            <img src="/static/img/1x/GatePostButton.webp"/>
        </a>
    </div>

    <div id="modalContainer">
        
            <input type="text" id="inputText">
        
    </div>

    <img  class="centerImg" src="/static/img/logos/RightNowCenter.svg" alt="">

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            var modalContainer = document.getElementById('modalContainer');
            var inputText = document.getElementById('inputText');
            var x_coordinate, y_coordinate;

            function showModal() {
                modalContainer.style.display = 'block';
                inputText.value = ''; // 입력값 초기화
                inputText.focus();
            }

            function hideModal() {
                modalContainer.style.display = 'none';
            }

            function handleSubmit() {
                hideModal();

                var image_number = Math.floor(Math.random() * 10) + 1;
                var userInput = inputText.value;

                var size = Math.floor(Math.random() * 5) + 1;
                var rotation = Math.floor(Math.random() * 3) + 1;

                console.log(`x:${x_coordinate} y:${y_coordinate} 이미지 넘버:${image_number} 내용:${userInput} 사이즈:${size} 회전:${rotation}`);
                var data = {
                    x_coordinate: x_coordinate,
                    y_coordinate: y_coordinate,
                    image_number: image_number,
                    content: userInput,
                    size: size,
                    rotation: rotation
                };

                axios.post('/uploadPost', data)
                    .then(function (response) {
                        console.log('데이터가 성공적으로 전송되었습니다.', response);
                        location.reload();
                    })
                    .catch(function (error) {
                        console.log('데이터 전송 중 에러 발생:', error);
                    });
            }

            document.addEventListener('click', function (event) {
                x_coordinate = event.clientX;
                y_coordinate = event.clientY;

                showModal();
            });

            inputText.addEventListener('keyup', function (e) {
                if (e.key === 'Enter') {
                    handleSubmit();
                }
            });
           
        });

        //post 표시
        function getPost() {
            // 서버에 전달할 데이터 객체 (예: data)
            const data = {
                // 데이터 필드 추가 (필요에 따라)
                // 예: key: value,
            };

            // axios를 사용하여 서버에 POST 요청을 보냅니다.
            axios.post('/getPost', data)
                .then((res) => {
                    // 서버로부터 받은 데이터를 콘솔에 출력
                    console.log(res.data);

                    // 여기서 서버로부터 받은 데이터를 활용하여 필요한 작업을 수행할 수 있습니다.
                    // 예를 들어, 받은 데이터를 가지고 동적으로 HTML을 생성하거나 화면에 표시할 수 있습니다.

                    // 예시: 받은 데이터를 반복하여 화면에 추가
                    for (let i = 0; i < res.data.length; i++) {
                        // res.data[i]를 이용하여 각각의 데이터에 접근할 수 있습니다.
                         예시: $("body").append(`<div>${res.data[i].content}</div>`);
                    }
                })
                .catch((error) => {
                    // 오류 발생 시 처리
                    console.error('Error fetching data:', error);
                });
        }

// 함수 호출
        getPost();

    </script>
</body>
</html>
